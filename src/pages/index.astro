---
import Layout from '../layouts/Layout.astro';
---

<Layout title="Willkommen">
  <div class="text-center py-12">
    <h1 class="text-4xl font-bold text-gray-900 mb-4">
      Willkommen beim <span class="text-red-600">TTSG Ostfildern</span> Trainingsplaner
    </h1>
    <p class="text-xl text-gray-600 mb-8">
      Organisiere dein Training beim TTSG Ostfildern einfach und effizient
    </p>

    <div id="auth-buttons"></div>
  </div>

  <div class="mt-16 grid md:grid-cols-3 gap-8">
    <div class="bg-white p-6 rounded-lg shadow-lg border-2 border-red-100 hover:border-red-300 transition-colors">
      <div class="text-3xl mb-4">ðŸ‘¥</div>
      <h3 class="text-lg font-semibold mb-2 text-red-600">FÃ¼r Spieler</h3>
      <p class="text-gray-600">
        Melde dich einfach zu Trainings beim TTSG Ostfildern an und behalte den Ãœberblick Ã¼ber deine Teilnahme.
      </p>
    </div>

    <div class="bg-white p-6 rounded-lg shadow-lg border-2 border-gray-200 hover:border-gray-900 transition-colors">
      <div class="text-3xl mb-4">ðŸ“‹</div>
      <h3 class="text-lg font-semibold mb-2 text-gray-900">FÃ¼r Trainer</h3>
      <p class="text-gray-600">
        Erstelle Trainings und sehe sofort, wer teilnimmt und wer absagt.
      </p>
    </div>

    <div class="bg-white p-6 rounded-lg shadow-lg border-2 border-red-100 hover:border-red-300 transition-colors">
      <div class="text-3xl mb-4">âš¡</div>
      <h3 class="text-lg font-semibold mb-2 text-red-600">Einfach & Schnell</h3>
      <p class="text-gray-600">
        Keine komplizierten Formulare - schnell anmelden und loslegen!
      </p>
    </div>
  </div>
</Layout>

<script>
  import { getUser, getUserRole } from '../lib/auth';

  async function init() {
    const container = document.getElementById('auth-buttons')!;
    const user = await getUser();

    if (user) {
      // User is logged in
      const userData = await getUserRole(user.id);
      const dashboardUrl = userData.role === 'trainer' ? '/trainer/dashboard' : '/trainings';
      const buttonText = userData.role === 'trainer' ? 'Zum Trainer-Dashboard' : 'Zu den Trainings';

      container.innerHTML = `
        <div class="space-y-4">
          <a
            href="${dashboardUrl}"
            class="inline-block px-6 py-3 text-lg font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 transition-colors shadow-lg"
          >
            ${buttonText}
          </a>
        </div>
      `;
    } else {
      // User is not logged in
      container.innerHTML = `
        <div class="space-x-4">
          <a
            href="/register"
            class="inline-block px-6 py-3 text-lg font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 transition-colors shadow-lg"
          >
            Jetzt registrieren
          </a>
          <a
            href="/login"
            class="inline-block px-6 py-3 text-lg font-medium text-white bg-gray-900 rounded-lg hover:bg-black transition-colors shadow-lg"
          >
            Anmelden
          </a>
        </div>
      `;
    }
  }

  init();
</script>
